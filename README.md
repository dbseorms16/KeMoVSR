# KeMoVSR
## Kernel Shape Adaptive Memory Network for Blind Video Super-Resolution


## Directory Structure

``` text
project
│   README.md
└───dataset - make symbolic link of your data here
└───pretrained_models - put the downloadedpretrained model here
└───codes
│   └───data
│       │   common.py
│       │   data_sampler.py
│       │   old_kernel_generator.py
│       │   random_kernel_generator.py
│       └───baseline - for finetuning the VSR network
│       └───estimator - for training MFDN, SFDN
│       └───meta_learner - training maml network
│   └───data_scripts - miscellaneous scripts (same as EDVR)
│   └───metrics - metric calculation (same as EDVR)
│   └───models - model collections
│   └───options
│       └───test - ymls for testing the networks
│       └───train - ymls for training the networks
│       │   options.py
│   └───scripts
│   └───utils
|   calc_psnr_ssim.py - code for calculating psnrs and ssims for image sets
|   degradation_gen.py - code for generating the preset kernel
|   make_downscaled_images.py - code for making true slr images
|   make_slr_images.py - code for making slr images generated by MFDN, SFDN
|   train.py - code for training the VSR network
|   train_dynavsr.py  - code for training DynaVSR
|   train_mfdn.py - code for training MFDN, SFDN network
|   test_maml.py - code for testing DynaVSR
|   test_Vid4_REDS4_with_GT(_DUF, _TOF).py - code for testing baseline VSR network
|   run_downscaling.sh - scripts for generating LR, SLR images
|   run_visual.sh - scripts for testing DynaVSR
| ...
```### Training
Two ways to train DynaVSR network.
- Distributed training(When using multiple GPUs).
  ```
  cd ./codes
  python -m torch.distributed.launch --nproc_per_node=8 --master_port=4321 train_dynavsr.py -opt options/train/[Path to YML file] --launcher pytorch --exp_name [Experiment Name]
  ```
- Single GPU training.
  ```
  cd ./codes
  python train_dynavsr.py -opt options/train/[Path to YML file] --exp_name [Experiment Name]
  ```

### Testing

- We just support single GPU for testing. 
  - To use your own test set, change the dataroot in [`EDVR_Demo.yml`](https://github.com/esw0116/DynaVSR/blob/master/codes/options/test/EDVR/EDVR_Demo.yml#L37) file to the folder containing images.

  ```
  cd ./codes
  python test_dynavsr.py -opt options/test/[Path to YML file]
  ```


- Or just use [`run_visual.sh`](https://github.com/esw0116/DynaVSR/blob/master/codes/run_visual.sh) (Uncomment line that you want to execute).
  ```
  sh ./codes/run_visual.sh
  ```

## Results

<center><img src="./figures/dynavsr_qualitative1.png" width="100%"></center>

<br>
